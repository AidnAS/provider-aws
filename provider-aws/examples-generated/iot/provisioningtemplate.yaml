apiVersion: iot.aws.upbound.io/v1alpha1
kind: ProvisioningTemplate
metadata:
  name: example
spec:
  forProvider:
    description: My provisioning template
    name: FleetTemplate
    provisioningRoleArnRef:
      name: example
    templateBody: |-
      ${jsonencode({
          Parameters = {
            SerialNumber = { Type = "String" }
          }

          Resources = {
            certificate = {
              Properties = {
                CertificateId = { Ref = "AWS::IoT::Certificate::Id" }
                Status        = "Active"
              }
              Type = "AWS::IoT::Certificate"
            }

            policy = {
              Properties = {
                PolicyName = aws_iot_policy.device_policy.name
              }
              Type = "AWS::IoT::Policy"
            }
          }
        })}
  providerConfigRef:
    name: example
