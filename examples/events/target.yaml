apiVersion: events.aws.upbound.io/v1beta1
kind: Target
metadata:
  name: console-target
spec:
  forProvider:
    arnSelector:
      matchLabels:
        testing.upbound.io/example-name: test-stream
    region: us-west-1
    ruleSelector:
      matchLabels:
        testing.upbound.io/example-name: console-rule
    runCommandTargets:
      - key: tag:Name
        values:
          - FooBar
      - key: InstanceIds
        values:
          - i-162058cd308bffec2
    targetId: ConsoleTarget
    eventBusNameSelector:
      matchLabels:
        testing.upbound.io/example-name: target-bus

---

apiVersion: events.aws.upbound.io/v1beta1
kind: Rule
metadata:
  labels:
    testing.upbound.io/example-name: console-rule
  name: console-rule
spec:
  forProvider:
    description: Capture all EC2 scaling events
    eventPattern: |
      {
        "source": [
          "aws.autoscaling"
        ],
        "detail-type": [
          "EC2 Instance Launch Successful",
          "EC2 Instance Terminate Successful",
          "EC2 Instance Launch Unsuccessful",
          "EC2 Instance Terminate Unsuccessful"
        ]
      }
    name: capture-ec2-scaling-events
    region: us-west-1
    eventBusNameSelector:
      matchLabels:
        testing.upbound.io/example-name: target-bus

---

apiVersion: kinesis.aws.upbound.io/v1beta1
kind: Stream
metadata:
  labels:
    testing.upbound.io/example-name: test-stream
  name: test-stream
spec:
  forProvider:
    region: us-west-1
    shardCount: 1

---

apiVersion: events.aws.upbound.io/v1beta1
kind: Bus
metadata:
  labels:
    testing.upbound.io/example-name: target-bus
  name: target-bus
spec:
  forProvider:
    region: us-west-1
